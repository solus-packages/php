name       : php
version    : 7.0.13
release    : 30
source     :
    - http://php.net/distributions/php-7.0.13.tar.xz : 357ba7f93975d7d836abed0852dc3ed96a988af539e87750613294cbee82f1bf
license    : PHP License
component  : programming
summary    : PHP is a popular general-purpose scripting language that is especially suited to web development.
description: |
    PHP is a popular general-purpose scripting language that is especially suited to web development.
builddeps  :
    - pkgconfig(enchant)
    - pkgconfig(freetype2)
    - pkgconfig(gdlib)
    - pkgconfig(icu-i18n)
    - pkgconfig(libcurl)
    - pkgconfig(libexif)
    - pkgconfig(libpng)
    - pkgconfig(libpq)
    - pkgconfig(libxml-2.0)
    - pkgconfig(libxslt)
    - pkgconfig(libzip)
    - pkgconfig(openssl)
    - pkgconfig(sqlite3)
    - pkgconfig(zlib)
    - bzip2
    - gettext-devel
    - gmp-devel
    - mcrypt
    - libjpeg-turbo-devel
    - libmcrypt-devel
    - libmhash-devel
    - libtool
    - pam-devel
setup      : |
    unset LD_AS_NEEDED
    export EXTENSION_DIR=%libdir%/php/modules/
    cp $pkgfiles/php.ini-production ./

    # Swap out /var/run for /run

    sed -i 's:/var/run:/run:' ext/fileinfo/tests/magic
    sed -i 's:/var/run:/run:' sapi/phpdbg/phpdbg.init.d

    libtoolize --force
    aclocal
    autoconf

    %configure --prefix=/usr --disable-static --with-config-file-path=/etc/php/ --bindir=/usr/bin/ --mandir=/usr/share/man \
         --disable-cgi \
         --enable-calendar=shared \
         --enable-exif=shared \
         --enable-fpm \
         --enable-ftp=shared \
         --enable-intl=shared \
         --enable-mbstring \
         --enable-opcache \
         --enable-phar \
         --enable-posix=shared \
         --enable-shmop=shared \
         --enable-soap=shared \
         --enable-libxml=shared \
         --enable-zip=shared \
         --mandir=/usr/share/man \
         --sysconfdir=/etc/php \
         --with-bz2=shared \
         --with-config-file-path=/etc/php \
         --with-config-file-scan-dir=/etc/php/conf.d \
         --with-curl=shared \
         --with-enchant=shared \
         --with-freetype-dir=/usr \
         --with-gd=shared \
         --with-gettext=shared \
         --with-gmp=shared \
         --with-iconv=shared \
         --with-icu-dir=/usr \
         --with-jpeg-dir=/usr \
         --with-libdir=lib64 \
         --with-libzip \
         --with-mcrypt=shared \
         --with-mhash \
         --with-openssl \
         --with-openssl-dir=/usr/bin \
         --with-pdo-pgsql=shared \
         --with-pdo-sqlite=shared \
         --with-pgsql=shared \
         --with-png-dir=/usr \
         --with-sqlite3=shared \
         --with-xsl=/usr \
         --with-zlib
make       : |
    unset LD_AS_NEEDED
    export EXTENSION_DIR=%libdir%/php/modules/
    %make
install    : |
    unset LD_AS_NEEDED
    export EXTENSION_DIR=%libdir%/php/modules/
    make INSTALL_ROOT=%installroot% install
    rm -rf $installdir/usr/lib64/build
    rm -rf $installdir/usr/lib64/php/modules/*.a
    install $pkgfiles/php.ini-production $installdir/etc/php/php.ini
    rm -rf $installdir/usr/include/php/include
    rm -rf %installroot%/var
    rm -rf $installdir/.{channels,depdb,depdblock,filemap,lock,registry}
